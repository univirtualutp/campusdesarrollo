{"version":3,"sources":["common.js"],"names":["define","$","SELECTORS","ACTIVITY_TOGGLE","ACTIVITY_TOGGLE_CLASS","ACTIVITY_TOGGLE_WRAPPER","FIRST_SECTION","SHOW","TOGGLE_HIGHLIGHT","TOGGLE_SHOWHIDE","DELETE","BUTTON_HIDE","BUTTON_SHOW","ACTIVITYBUTTON_HIDE","ACTIVITYBUTTON_SHOW","ACTIVITYDUPLICATE","ACTIVITIYDELETE","adjustGeneralSectionActivities","length","width","window","getActivitiesPerRow","removeClass","hide","show","addClass","init","on","this","hasClass","html","M","util","get_string","toggleClass","animate","scrollTop","offset","top","setTimeout","location","reload","event","preventDefault","attr","href","moodleversionbranch","height","find"],"mappings":"AAuBAA,OAAO,CAAC,UAAW,SAASC,GAExB,IAAIC,EAAY,CACZC,gBAAiB,gBACjBC,sBAAuB,mBACvBC,wBAAyB,uBACzBC,cAAe,aACfC,KAAM,OACNC,iBAAkB,wDAClBC,gBAAiB,uDACjBC,OAAQ,qDACRC,YAAa,+CACbC,YAAa,+CACbC,oBAAqB,wDACrBC,oBAAqB,wDACrBC,kBAAmB,mDACnBC,gBAAiB,kDA+BrB,SAASC,IACDhB,EAAEC,EAAUI,cAAgB,sCAAsCY,QAzB1E,WACI,IAAIC,EAAQlB,EAAEmB,QAAQD,QACtB,OAAIlB,EAAE,sBAAsBiB,OACpBC,GAAS,IACF,EAEPA,GAAS,IACF,EAEJ,EAEHA,GAAS,IACF,EAEPA,GAAS,IACF,EAEJ,EAQqEE,IAC5EpB,EAAEC,EAAUI,eAAegB,YAAYpB,EAAUE,uBACjDH,EAAEC,EAAUG,yBAAyBkB,SAErCtB,EAAEC,EAAUG,yBAAyBmB,OACrCvB,EAAEC,EAAUI,eAAemB,SAASvB,EAAUE,wBAoGtD,MAAO,CACHsB,KA9FJ,WAEIzB,EAAE,8EAA8EwB,SAAS,mBAEzFR,IAYAhB,EAAEC,EAAUC,iBAAiBwB,GAAG,QAAS,WAEjC1B,EAAE2B,MAAMC,SAAS3B,EAAUK,OAC3BN,EAAE2B,MAAME,KAAKC,EAAEC,KAAKC,WAAW,WAAY,uBAC3ChC,EAAE2B,MAAMM,YAAYhC,EAAUK,QAE9BN,EAAE2B,MAAME,KAAKC,EAAEC,KAAKC,WAAW,WAAY,uBAC3ChC,EAAE2B,MAAMM,YAAYhC,EAAUK,MAC9BN,EAAE,cAAckC,QAAQ,CACpBC,UAAWnC,EAAEC,EAAUI,cAAgB,iDAAiD+B,SAASC,IAAM,IACxG,SAEPrC,EAAEC,EAAUI,eAAe4B,YAAYhC,EAAUE,yBAIrDH,EAAE,QAAQ0B,GAAG,WAAYzB,EAAUM,qDACVN,EAAUO,oDACVP,EAAUS,gDACVT,EAAUU,gDACVV,EAAUW,wDACVX,EAAUY,sBAAuB,WACtDyB,WAAW,WACPC,SAASC,UACV,OAIPxC,EAAE,QAAQ0B,GAAG,WAAYzB,EAAUa,oBAAqB,WACpDwB,WAAW,WACPC,SAASC,UACV,OAIPxC,EAAE,QAAQ0B,GAAG,WAAYzB,EAAUc,mBAAmBd,EAAUQ,SAAU,SAASgC,GAY/E,OAXAA,EAAMC,iBAC6B,YAA/B1C,EAAE2B,MAAMgB,KAAK,iBACbxB,OAAOoB,SAASK,KAAO5C,EAAE2B,MAAMgB,KAAK,SAEL,iBAA/B3C,EAAE2B,MAAMgB,KAAK,iBACTE,qBAAuB,MACvBN,SAASC,SAETrB,OAAOoB,SAASK,KAAO5C,EAAE2B,MAAMgB,KAAK,UAGrC,IAIX3C,EAAE,QAAQ0B,GAAG,QAAS,4BAA6B,SAASe,GAIxD,OAHAH,WAAW,KACPC,SAASC,UACV,MACI,IAGSxC,EAAE,qBAAqB8C,SAEvB,MAChB9C,EAAE,uBAAuB+C,KAAK,gBAAgB1B,YAAY,UAC1DrB,EAAE,qBAAqBwB,SAAS,qBAAqBH,YAAY,qBAErErB,EAAE,gBAAgB0B,GAAG,QAAS,WAC1B1B,EAAE,qBAAqBwB,SAAS,oBAAoBH,YAAY,qBAChErB,EAAE,uBAAuB+C,KAAK,gBAAgBvB,SAAS,UACvDxB,EAAE,uBAAuB+C,KAAK,gBAAgB1B,YAAY,YAE9DrB,EAAE,gBAAgB0B,GAAG,QAAS,WAC1B1B,EAAE,qBAAqBwB,SAAS,qBAAqBH,YAAY,oBACjErB,EAAE,uBAAuB+C,KAAK,gBAAgB1B,YAAY,UAC1DrB,EAAE,uBAAuB+C,KAAK,gBAAgBvB,SAAS,aAO3DR,+BAAgCA","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Enhancements to Lists components for easy course accessibility.\n *\n * @module     format/remuiformat\n * @copyright  WisdmLabs\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function($) {\n\n    var SELECTORS = {\n        ACTIVITY_TOGGLE: '.showactivity',\n        ACTIVITY_TOGGLE_CLASS: 'showhideactivity',\n        ACTIVITY_TOGGLE_WRAPPER: '.showactivitywrapper',\n        FIRST_SECTION: '#section-0',\n        SHOW: 'show',\n        TOGGLE_HIGHLIGHT: '.section_action_menu .dropdown-item.editing_highlight',\n        TOGGLE_SHOWHIDE: '.section_action_menu .dropdown-item.editing_showhide',\n        DELETE: '.section_action_menu .dropdown-item.editing_delete',\n        BUTTON_HIDE: '.cm_action_menu .dropdown-menu .editing_hide',\n        BUTTON_SHOW: '.cm_action_menu .dropdown-menu .editing_show',\n        ACTIVITYBUTTON_HIDE: '.cm_action_menu .dropdown-menu [data-action=\"cmHide\"]',\n        ACTIVITYBUTTON_SHOW: '.cm_action_menu .dropdown-menu [data-action=\"cmShow\"]',\n        ACTIVITYDUPLICATE: '.cm_action_menu .dropdown-item.editing_duplicate',\n        ACTIVITIYDELETE: '.cm_action_menu  .dropdown-item.editing_delete'\n    };\n\n    /**\n     * Get number activities can be shown in first row and hide rest\n     * @return {Integer} Number activities in first row\n     */\n    function getActivitiesPerRow() {\n        let width = $(window).width();\n        if ($('.remui-format-list').length) {\n            if (width >= 992) {\n                return 4;\n            }\n            if (width >= 768) {\n                return 3;\n            }\n            return 2;\n        } else {\n            if (width >= 768) {\n                return 4;\n            }\n            if (width >= 481) {\n                return 2;\n            }\n            return 1;\n        }\n    }\n\n    /**\n     * Adjust the general section activities visibility after first row\n     */\n    function adjustGeneralSectionActivities() {\n        if ($(SELECTORS.FIRST_SECTION + '  ul.general-section-activities li').length <= getActivitiesPerRow()) {\n            $(SELECTORS.FIRST_SECTION).removeClass(SELECTORS.ACTIVITY_TOGGLE_CLASS);\n            $(SELECTORS.ACTIVITY_TOGGLE_WRAPPER).hide();\n        } else {\n            $(SELECTORS.ACTIVITY_TOGGLE_WRAPPER).show();\n            $(SELECTORS.FIRST_SECTION).addClass(SELECTORS.ACTIVITY_TOGGLE_CLASS);\n        }\n    }\n    /**\n     * Init method\n     *\n     */\n    function init() {\n\n        $('#page-course-view-remuiformat .section-modchooser-link:not(.dropdown-item)').addClass(\"btn btn-primary\");\n\n        adjustGeneralSectionActivities();\n        // It should not be change during resize of screen it causing issue on mobile view so I am commenting it\n        // $(window).resize(function() {\n        //     adjustGeneralSectionActivities();\n        // });\n\n        // if ($(\".general-section-activities li:last\").css('display') == 'none') {\n        //     $(\".showactivitywrapper\").show();\n        // } else {\n        //     $(\".showactivitywrapper\").hide();\n        // }\n\n        $(SELECTORS.ACTIVITY_TOGGLE).on('click', function() {\n\n            if ($(this).hasClass(SELECTORS.SHOW)) {\n                $(this).html(M.util.get_string('showless', 'format_remuiformat'));\n                $(this).toggleClass(SELECTORS.SHOW); // Remove show class\n            } else {\n                $(this).html(M.util.get_string('showmore', 'format_remuiformat'));\n                $(this).toggleClass(SELECTORS.SHOW); // Add show class\n                $(\"html, body\").animate({\n                    scrollTop: $(SELECTORS.FIRST_SECTION + ' ul.general-section-activities li:first-child').offset().top - 66\n                }, \"slow\");\n            }\n            $(SELECTORS.FIRST_SECTION).toggleClass(SELECTORS.ACTIVITY_TOGGLE_CLASS);\n        });\n\n        // Handling highlight and show hide dropdown.\n        $('body').on('click', `${SELECTORS.TOGGLE_HIGHLIGHT},\n                               ${SELECTORS.TOGGLE_SHOWHIDE},\n                               ${SELECTORS.BUTTON_HIDE},\n                               ${SELECTORS.BUTTON_SHOW},\n                               ${SELECTORS.ACTIVITYBUTTON_HIDE},\n                               ${SELECTORS.ACTIVITYBUTTON_SHOW}`, function() {\n            setTimeout(function() {\n                location.reload();\n            }, 400);\n        });\n\n        // Handling activity duplicate.\n        $('body').on('click', `${SELECTORS.ACTIVITYDUPLICATE}`, function() {\n            setTimeout(function() {\n                location.reload();\n            }, 200);\n        });\n\n        // Handling deleteAction\n        $('body').on('click', `${SELECTORS.ACTIVITIYDELETE},${SELECTORS.DELETE}`, function(event) {\n            event.preventDefault();\n            if ($(this).attr('data-action') == 'cmDelete') {\n                window.location.href = $(this).attr('href');\n            }\n            if ($(this).attr('data-action') == 'deleteSection') {\n                if (moodleversionbranch >= '405') {\n                    location.reload();\n                } else {\n                    window.location.href = $(this).attr('href');\n                }\n            }\n            return true;\n        });\n\n        // Handling addSubsection\n        $('body').on('click', '[data-action=\"addModule\"]', function(event) {\n            setTimeout(() => {\n                location.reload();\n            }, 200);\n            return true;\n        });\n\n        var summaryheight = $('.read-more-target').height();\n\n        if (summaryheight > 300) {\n            $('.generalsectioninfo').find('#readmorebtn').removeClass('d-none');\n            $('.read-more-target').addClass('summary-collapsed').removeClass('summary-expanded');\n        }\n        $('#readmorebtn').on('click', function() {\n            $('.read-more-target').addClass('summary-expanded').removeClass('summary-collapsed');\n            $('.generalsectioninfo').find('#readmorebtn').addClass('d-none');\n            $('.generalsectioninfo').find('#readlessbtn').removeClass('d-none');\n        });\n        $('#readlessbtn').on('click', function() {\n            $('.read-more-target').addClass('summary-collapsed').removeClass('summary-expanded');\n            $('.generalsectioninfo').find('#readmorebtn').removeClass('d-none');\n            $('.generalsectioninfo').find('#readlessbtn').addClass('d-none');\n        });\n\n    }\n\n    return {\n        init: init,\n        adjustGeneralSectionActivities: adjustGeneralSectionActivities\n    };\n});\n"],"file":"common.min.js"}